name: Dependabot PR Notification

on:
  pull_request:
    types: [opened]

jobs:
  notify:
    if: github.actor == 'dependabot[bot]'
    runs-on: ubuntu-latest
    timeout-minutes: 1
    steps:
      - name: Send email via Resend
        run: |
          curl -s -X POST https://api.resend.com/emails \
            -H "Authorization: Bearer ${{ secrets.RESEND_API_KEY }}" \
            -H "Content-Type: application/json" \
            -d @- <<EOF
          {
            "from": "Gåri <noreply@gaari.no>",
            "to": "post@gaari.no",
            "subject": "[Dependabot] ${{ github.event.pull_request.title }}",
            "text": "Dependabot har åpnet en ny PR:\n\n${{ github.event.pull_request.title }}\n\n${{ github.event.pull_request.html_url }}\n\nSe over og merge om alt ser bra ut."
          }
          EOF
